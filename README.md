Rewrote the code with little different funcition 
